# 多样化主题切换的可能实现方案2

by Jerry

在《[多样化主题切换的可能实现方案](./多样化主题切换的可能实现方案.md)》中，我提出了一种先将图像进行“灰度”处理，再进行线性映射的方法。但是，在进行“灰度”处理后，图像的信息损失了，它无法再变回原图像。下面提出一种可以使图像不损失信息的变换方法——线性变换。

> PS：尽管我不知道保留图像的信息对一个 PDF 阅读器来说有什么用…

## 实现

下面，还是将颜色的 RGB 值视为一个三元向量，但这次用列向量，例如：

- 红色： $\vec{c}_{R} = \begin{bmatrix} 255 \\ 0 \\ 0 \end{bmatrix}$ 。
- 绿色： $\vec{c}_{G} = \begin{bmatrix} 0 \\ 255 \\ 0 \end{bmatrix}$ 。
- 蓝色： $\vec{c}_{G} = \begin{bmatrix} 0 \\ 0 \\ 255 \end{bmatrix}$ 。

它们的单位向量分别记为 $\vec{e}_{R} = \begin{bmatrix} 1 \\ 0 \\ 0 \end{bmatrix}, \vec{e}_{G} = \begin{bmatrix} 0 \\ 1 \\ 0 \end{bmatrix}, \vec{e}_{B} = \begin{bmatrix} 0 \\ 0 \\ 1 \end{bmatrix}$ 。

将这三个单位向量作为基底。

现有一种变换，将基底映射为：
$$
\begin{bmatrix} 1 \\ 0 \\ 0 \end{bmatrix} \mapsto \vec{e}_{1}, 
\begin{bmatrix} 0 \\ 1 \\ 0 \end{bmatrix} \mapsto \vec{e}_{2},
\begin{bmatrix} 0 \\ 0 \\ 1 \end{bmatrix} \mapsto \vec{e}_{3}
$$
注：$\vec{e}_{1}, \vec{e}_{2}, \vec{e}_{3}$ 也都是单位向量。

则变换矩阵为：
$$
\boldsymbol{M} = \begin{bmatrix} \vec{e}_{1} & \vec{e}_{2} & \vec{e}_{3} \end{bmatrix}
$$
即
$$
\boldsymbol{M} \vec{e}_{R} = \vec{e}_{1}, \boldsymbol{M} \vec{e}_{G} = \vec{e}_{2}, \boldsymbol{M} \vec{e}_{B} = \vec{e}_{3}
$$
那么，对于一个在“原颜色系” $(\vec{e}_{R}, \vec{e}_{G}, \vec{e}_{B})$ 的颜色 $\vec{c}$ ，其在新“颜色系” $(\vec{e}_{1}, \vec{e}_{2}, \vec{e}_{3})$ 下的颜色就是
$$
\vec{c}' = \boldsymbol{M} \vec{c}
$$
当 $\boldsymbol{M}$ 是非退化（满秩）的时，颜色 $\vec{c}'$ 可以通过逆变换变回 $\vec{c} = \boldsymbol{M}^{-1} \vec{c}'$ ，从而避免了颜色信息的丢失。

## 与方案1兼容

若方案一中的灰度函数是关于 R、G、B 值线性的，那么可以构造一个变换矩阵（退化的）来实现方案1的变换，即，方案1就是方案2的特例。

## 特点

与方案1相比，方案2的：

- **优点**：
    - 避免颜色信息的丢失，色彩丰富。
    - 灵活度高，可以兼容方案1。
- **缺点**：
    - 用户需要选择3种颜色，麻烦。
    - 映射关系不够直观。